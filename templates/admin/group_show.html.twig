{% extends 'back/base.html.twig' %}
{% set panel = 'admin' %}

{% block title %}Admin | Group Details{% endblock %}

{% block content %}
  <section class="panel">
    <h1 style="margin:0 0 8px">{{ group.name }}</h1>
    <p style="margin:4px 0;color:#bdd0ed"><strong>Created at:</strong> {{ group.createdAt ? group.createdAt|date('Y-m-d H:i') : '-' }}</p>
    <p style="margin:4px 0;color:#bdd0ed"><strong>Created by:</strong> {{ group.createdBy ?: teacherName }}</p>
    <p style="margin:4px 0;color:#bdd0ed"><strong>Teacher:</strong> {{ teacherName }}</p>
  </section>

  <section class="panel" style="margin-top:12px">
    <h3 style="margin-top:0">Edit Group</h3>
    <form method="post" action="{{ path('admin_group_edit', {'id': group.id}) }}">
      <input type="hidden" name="_token" value="{{ csrf_token('admin_group_edit_' ~ group.id) }}">
      <input type="text" name="name" value="{{ group.name }}" required style="width:100%;padding:10px;border-radius:10px;border:1px solid rgba(197,218,255,.25);background:#0d2444;color:#fff">
      <p style="margin:10px 0 0">
        <button type="submit" class="action gold" style="margin:0;border:none;cursor:pointer">Save</button>
      </p>
    </form>
    <form method="post" action="{{ path('admin_group_delete', {'id': group.id}) }}" style="margin-top:8px">
      <input type="hidden" name="_token" value="{{ csrf_token('admin_group_delete_' ~ group.id) }}">
      <button type="submit" class="action" style="margin:0;border:none;cursor:pointer">Delete Group</button>
    </form>
  </section>

  <section class="panel" style="margin-top:12px">
    <h3 style="margin-top:0">Members (Students)</h3>
    <table style="width:100%;border-collapse:collapse">
      <thead>
        <tr>
          <th style="text-align:left;padding:8px 4px;border-bottom:1px solid rgba(197,218,255,.25)">Name</th>
          <th style="text-align:left;padding:8px 4px;border-bottom:1px solid rgba(197,218,255,.25)">Email</th>
          <th style="text-align:left;padding:8px 4px;border-bottom:1px solid rgba(197,218,255,.25)">Grade</th>
          <th style="text-align:left;padding:8px 4px;border-bottom:1px solid rgba(197,218,255,.25)">Avg Score</th>
        </tr>
      </thead>
      <tbody>
        {% for member in members %}
          <tr>
            <td style="padding:10px 4px;border-bottom:1px solid rgba(197,218,255,.15)">{{ member.name ?: '-' }}</td>
            <td style="padding:10px 4px;border-bottom:1px solid rgba(197,218,255,.15)">{{ member.email ?: '-' }}</td>
            <td style="padding:10px 4px;border-bottom:1px solid rgba(197,218,255,.15)">{{ member.grade ?: '-' }}</td>
            <td style="padding:10px 4px;border-bottom:1px solid rgba(197,218,255,.15)">{{ member.avgScore is not null ? member.avgScore|number_format(1) ~ '%' : '-' }}</td>
          </tr>
        {% else %}
          <tr><td colspan="4" style="padding:10px 4px;color:#bdd0ed">No members in this group.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
{% endblock %}
